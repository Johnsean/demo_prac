# Lesson 30. äº‹ä»¶

### é¢„è§ˆï¼š

1.  **å†å²**

   >ä¹‹çˆ¶å‘æ˜ä¸‰ä¸ªç¬¬ä¸€ï¼šæœåŠ¡å™¨/æµè§ˆå™¨/ç½‘é¡µ       ---ã€‹ä¸‡ç»´ç½‘
   >
   >æµè§ˆå™¨çœŸæ­£å¥½ç”¨=> æµè§ˆå™¨å¤§æˆ˜ ç½‘æ™¯ï¼šnovigator   ==> firfox    IE:  ==> Edge     ä¸€ç›´åˆ°ç°åœ¨çš„Chrome 

2. **ç±»åˆ«**

   >ä»¥å‰äº‹ä»¶ æ˜¯è¡Œä¸šé»˜è®¤äº’ç›¸æ¨¡ä»¿ å¦‚ ***htmlä¸Šonclick='f1()'***  ***JS ä¸Š xxx.onclick=f1***   ==== ***DOM 0***   ï¼š **äº‹å®è§„èŒƒ**
   >
   >W3C   åˆ¶å®šè¡Œå†…è§„èŒƒï¼Œç»Ÿä¸€ä¸ªæµè§ˆå™¨ï¼Œæ±‡æ€»äº‹ä»¶  ï¼šå¯¹äº***DOM 0çš„äº‹ä»¶ä¸ä½œå˜æ›´***  =====***DOM 1***
   >
   >â€‹		***addEventlistener***    ===== ***DOM2***  

3. **æ¨¡å‹**

   >**äº‹ä»¶å¯¹è±¡æ¨¡å‹ ï¼š**  äº‹ä»¶å‘ç”Ÿæ—¶ **æ‰§è¡Œçš„é¡ºåº**ï¼š æ‰§è¡Œåœ¨ ***æ•è·é˜¶æ®µ*** è¿˜æ˜¯ ***å†’æ³¡é˜¶æ®µ***ã€é»˜è®¤ã€‘
   >
   >ç”±**ç¬¬ä¸‰ä¸ªå‚æ•°** ç¡®å®š   ***true***  ä¸º æ•è· ï¼šçˆ·çˆ·/çˆ¶äº²/å„¿å­  ***false*** `0 NaN '' null undefined` ä¸ºå†’æ³¡

4. **æ¡ˆä¾‹**



## **ä¸€ã€ äº‹ä»¶**

### 1. **DOM level**

***DOM 0***  ï¼š **äº‹å®è§„èŒƒ **      ***htmlä¸Šonclick='f1()'***  ***JS ä¸Š xxx.onclick=f1*** 

***DOM 1*** : æ±‡æ€»DOM 0çš„äº‹ä»¶ï¼Œä¸ä½œå˜æ›´

***DOM2***  : addEventlistener    



â€‹       ***DOM 0  DOM2*** **åŒºåˆ«**  ï¼š

â€‹            ***DOM 0***  ï¼š**å±æ€§** ï¼Œ**åªèƒ½ç»‘å®šä¸€ä¸ªã€‚**  åé¢ä¼šè¦†ç›–å‰é¢çš„ã€‚å†™çš„æ—¶å€™ä¸ç¡®å®š  ä¼šä¸ä¼šæŠŠå‰é¢çš„è¦†ç›–

``` javascript
// å±æ€§,å”¯ä¸€ 
xxx.onclick=funtion f1(){ }
xxx.onclick=funtion f2(){ }

// onclickå†…å­˜è¦†ç›–  f1è¢«gc 
```

â€‹        æ¨¡å‹ä¸å¥½ï¼Œæ‰€ä»¥ **Dom2**ï¼šé˜Ÿåˆ—é€»è¾‘  å…ˆè¿›å…ˆå‡º

``` javascript
// ç»‘å®šå¤šä¸ª  å…ˆè¿›å…ˆå‡º -> æŒ‰é¡ºåºè§¦å‘
xxx.addEventListener("click",f1)
xxx.addEventListener("click",f2)   // æ‰§è¡Œé¡ºåºf1()  f2()

// ç§»å‡ºé˜Ÿåˆ—ï¼š
xxx.removeEventListener("click",f2) 

// one äº‹ä»¶æ•ˆæœ
xxx.addEventListener("click", f1) //æ‰§è¡Œå®Œf1() åç§»å‡ºäº‹ä»¶é˜Ÿåˆ—
function f1(){
    console.log(1)  //f1 ä»£ç æœ«å°¾ æ·»åŠ  ğŸ‘‡ğŸ‘‡ğŸ‘‡
	xxx.removeEventListener("click",f1)    
}
```



### 2.äº‹ä»¶å¯¹è±¡æ¨¡å‹ï¼šè°å…ˆæ‰§è¡Œçš„é—®é¢˜

***div.yeye > div.baba > div.erzi***  :  ç‚¹å‡» ***erzi***  è§¦å‘æ‰§è¡Œçš„é¡ºåºï¼Ÿ

 yeye--> baba -->erzi  [æ•è·] è¿˜æ˜¯   erzi-->baba-->yeye  [å†’æ³¡]

``` javascript
//1. ç‚¹å‡»å„¿å­ çš„æ—¶å€™ï¼Œæ˜¯å¦ç‚¹å‡»äº† çˆ¸çˆ¸å’Œçˆ·çˆ·
  // yes
// 2. ç‚¹å‡»å„¿å­ çš„æ—¶å€™ï¼Œ ä¸‰ä¸ªå‡½æ•°æ˜¯å¦è°ƒç”¨   yes
yeye.addEventListener("click", f1) 
baba.addEventListener("click", f2) 
erzi.addEventListener("click", f3) 

//3. f1 f2 f3çš„æ‰§è¡Œé¡ºåºï¼Ÿ  1 2 3 or 3 2 1
 // w3c ï¼š éƒ½å¯ä»¥
```



ç”±`ç¬¬ä¸‰ä¸ªå‚æ•°`å†³å®šã€‚

> **æ³¨æ„**ï¼šå½“è§¦å‘ç›‘å¬åŒä¸€ä¸ªå…ƒç´ ï¼Œ ä¸åŒºåˆ†æ˜¯æ•è· è¿˜æ˜¯ å†’æ³¡ã€‚
>
> æ‰§è¡Œé¡ºåº   æ˜¯æŒ‰ç…§ ä»£ç å†™çš„é¡ºåºæ‰§è¡Œ  ï¼š**é˜Ÿåˆ—é€»è¾‘**

``` java
erzi.addEventListener("click", f3, true)   
erzi.addEventListener("click", f4, false) 

    //ç‚¹å‡»å„¿å­çš„æ—¶å€™ï¼Œf3 f4æ‰§è¡Œé¡ºåºä¸ä»£ç ä¹¦å†™é¡ºåºç›¸åŒ
```



**äº‹ä»¶æ¨¡å‹ï¼šå…ˆæ•è·å†å†’æ³¡ã€‚**

**å·¦è¾¹ï¼š æ•è·é˜¶æ®µ [ç¥–å…ˆ->è§¦å‘å…ƒç´ ]  å³è¾¹ï¼š å†’æ³¡é˜¶æ®µ [è§¦å‘å…ƒç´ -->ç¥–å…ˆ]**

> ç¬¬ä¸‰ä¸ªå‚æ•°çœŸå‡ å°±æ˜¯ç¡®å®š fn1 æ˜¯å·¦è¾¹è¿˜æ˜¯å³è¾¹çš„æ—¶å€™æ‰§è¡Œã€‚

>**1 2 3 éƒ½å¯ä»¥é€‰æ‹©æ˜¯å·¦è¾¹ è¿˜æ˜¯å³è¾¹æ‰§è¡Œ  è¿™ä¸¤ä¸ªé˜Ÿåˆ—**



### JQ äº‹ä»¶ä¸­ï¼š

[**event.target**](https://www.runoob.com/jquery/jq-event-target.html)                è¿”å›å“ªä¸ª DOM å…ƒç´ è§¦å‘äº‹ä»¶

[**event.currentTarget**](https://www.runoob.com/jquery/jq-event-currenttarget.html) åœ¨äº‹ä»¶**å†’æ³¡é˜¶æ®µå†…**çš„å½“å‰ DOM å…ƒç´ 



### 3.  æ¡ˆä¾‹ï¼šç‚¹å‡»åˆ«å¤„å…³é—­æµ®å±‚

**html**

``` html
  <div id="wrapper" class="wrapper">
    <button id="btn">æ‰“å¼€æµ®å±‚</button>
    <div class="popover" id="popover">æµ®å±‚</div>

  </div>

```

**css**

``` css
* {
  margin: 0;
  padding: 0;
}
.wrapper {
  position: relative;
  display: inline-block;
}
.popover {
  display: none;
  position: absolute;
  left: 100%;
  top: 0;
  padding: 10px;
  margin-left: 10px;
  border: 1px solid red;
  white-space: nowrap;  /* æ’‘å®½å®½åº¦ */
  background: white;
}
.popover:before {  /* ä¸‰è§’å½¢ */
  content: "";
  position: absolute;
  right: 100%;
  top: 5px;
  border: 10px solid transparent;
  border-right-color: red;
}
.popover:after { 
  content: "";
  position: absolute;
  right: 100%;
  top: 5px;
  margin-right: -1px; /* ä¸‰è§’å½¢æ¡† */
  border: 10px solid transparent;
  border-right-color: white;
}
```



**JS:**

>**æ³•1** å¤æ‚ï¼šç‚¹å‡»å‡ºç°æµ®å±‚åŒæ—¶é€æ˜é®ç½©å±‚ï¼Œç‚¹å‡»é®ç½©æ—¶å…³é—­æµ®å±‚ä¸é®ç½©
>
>**æ³•2** é˜»æ­¢è‡ªèº«å†’æ³¡[ä¸å†’æ³¡è§¦å‘ç¥–å…ˆå…ƒç´ ç‚¹å‡»äº‹ä»¶]
>
>**æ³•3** å˜ä½“  å»¶æ—¶ å†’æ³¡åå†å‡ºå‘ç¥–å…ˆä¹Ÿæ²¡äº‹ **åˆ©ç”¨å®šæ—¶å™¨**
>
>è®¾ç½®å®šæ—¶å™¨ å†’æ³¡æ‰§è¡Œå®Œæ‰ä¼šè§¦å‘ç‚¹å‡»

``` java
// 1.é˜»æ­¢å†’æ³¡   æ·»åŠ åˆ° wrapperçš„ç‚¹å‡»äº‹ä»¶ä¸Š ç‚¹å‡»æµ®å±‚æ‰ä¸ä¼šå…³é—­æµ®å±‚ï¼Œ
btn.addEventListener('click', function(e) {
  popover.style.display = 'block';
  e.stopPropagation(); // åˆ°btn ä¸ºæ­¢ åœæ­¢ä¼ æ’­   æµ®å±‚ä¸ºåŒçº§å…ƒç´  ç‚¹æµ®å±‚ä¼šå†’æ³¡
})
document.addEventListener('click', function() {
  popover.style.display = 'none';
})
```



**JQ**

``` javascript
$(btn).on('click',function(){
  $(popover).show();
})

$(wrapper).on('click',false)  // falseä»£è¡¨ã€€é˜»æ­¢å†’æ³¡ã€€é˜»æ­¢é»˜è®¤äº‹ä»¶

$(document).on('click',function(){
    $(popover).hide();
})
```

**æ³¨æ„**ï¼šã€€

>false æ—¶å€™ï¼Œæµ®å±‚å†…çš„checkbox ä¼šç‚¹ä¸äº†  å› ä¸ºé˜»æ­¢äº†é»˜è®¤äº‹ä»¶
>

``` java
// ç§»å‡ºä¸Šé¢çš„éšæ‚£
$(btn).on('click', function() {
  $(popover).show();
})

$(wrapper).on('click', function(e) {
  e.stopPropagation()
})

$(document).on('click', function() {
  $(popover).hide();
})
```

**èŠ‚çœå†…å­˜ ç‚¹å‡»é—­åˆ**

``` java
$(btn).on('click', function() {
  $(popover).show();
  $(document).one('click', function() {  // ç‚¹å‡»å…³é—­æµ®å±‚ æ”¾å…¥btnä¸­åˆ©ç”¨ oneäº‹ä»¶
    $(popover).hide();
  })
})

$(wrapper).on('click', function(e) {
  e.stopPropagation()
})
```

**å®šæ—¶å™¨** 

``` javascript
// ç‚¹å‡»æµ®å±‚ä¼šå…³é—­æµ®å±‚   å› ä¸ºå¹¶æ²¡æœ‰é˜»æ­¢æµ®å±‚çš„å†’æ³¡

$(btn).on('click', function() {
  $(popover).show();
  setTimeout(function() {  // å®šæ—¶å™¨  å†’æ³¡å®Œåœ¨æ‰§è¡Œ
    $(document).one('click', function() {
      $(popover).hide();
    })
  }, 0)  //0ç§’
})
```



### 4.[æ¡ˆä¾‹å†’æ³¡](http://js.jirengu.com/xeriq/1/)

```  html
  <div class="r">
    <div class="o">
      <div class="p">
        <div class="b">
          <div class="y"></div>
        </div>
      </div>
    </div>
  </div>
```

``` css
* {
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}
.r.active {
  background: red;
}
.o.active {
  background: orange;
}
.p.active {
  background: purple;
}
.b.active {
  background: blue;
}
.y.active {
  background: yellow;
}
div {
  border: 1px solid black;
  padding: 10px;
  display: flex;
  flex: 1;
  transition: all 1.5s;
  border-radius: 50%;
}
.r {
  width: 100vw;
  height: 100vw;
}
```

``` js
var n = 0;
$('div').on('click', function(e) {
  setTimeout(() => {
    $(e.currentTarget).addClass('active')
  }, n * 1000)
  n++
})
```

